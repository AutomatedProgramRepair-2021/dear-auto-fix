GZoltar
=======

# Run GZoltar

* `run_gzoltar.sh` script runs the [GZoltar](http://www.gzoltar.com/)
tool on a specified Defects4J project-bug using either manually
written test cases or automatically generated test cases.


Requirements:

* Java 7
* D4J_HOME - Must point to the Defects4J installation that is used to checkout, compile, test, etc.
* GZOLTAR_JAR - Must point to GZoltar's jar file. (GZoltar v1.6.0 can be found [here](http://www.gzoltar.com/lib/com.gzoltar-1.6.0-jar-with-dependencies.jar))
* EVOSUITE_JAR - Must point to EvoSuite's jar file if it is to run GZoltar with test cases generated by EvoSuite.


Usage:

```
  bash run_gzoltar.sh <pid> <vid> <data dir> <tool> [tests dir]
```

Where `<pid>` is a project name (e.g., Chart), `<vid>` is the bug id
(e.g., 5), and `<data dir>` is the directory to where the data
generated by GZoltar will be written. `<tool>` can be:

* _developer_ - to run GZoltar with manually-written test cases.
* _evosuite_ - to run GZoltar with automatically generated test cases by EvoSuite.
* _randoop_ - to run GZoltar with automatically generated test cases by Randoop.

Note: When `<tool>` is either _evosuite_ or _randoop_, `[tests dir]`
names the directory that contains the automatically
generated test cases. Otherwise, `[tests dir]` does not need to be
supplied.


Output:

Under `<data dir>` directory, `run_gzoltar.sh` script creates a
directory `gzoltars/<pid>/<vid>/` to which three files are written:

* `log.txt` - all debug/info messages produced by the `run_gzoltar.sh` script.
* `matrix` - a binary coverage matrix produced by GZoltar where each row represents the coverage of each individual test case and its outcome ("-" if the test case failed, "+" otherwise), and each column a line of code. 1 means that a test case covered a line of code, 0 otherwise.
* `spectra` - a list of all lines of code identified by GZoltar (one per row) of all classes under test.

At the end `run_gzoltar.sh` script compresses the data generated
(i.e., the directory `gzoltars/<pid>/<vid>/`) to the file
`<data dir>/<pid>-<vid>-<tool>-gzoltar-files.tar.gz`.


# Collect runtime information

* `collect_sbfl_runtimes.sh` script collects the time to run GZoltar on all
D4J's faults.


Requirements:

* D4J_HOME - Must point to the Defects4J installation.


Usage:

```
  bash collect_sbfl_runtimes.sh <directory with data generated by run_gzoltar.sh script>
```

Where `<directory with GZoltar files>` should point to the directory
with the `<pid>-<vid>-<tool>-gzoltar-files.tar.gz` files generated
by `run_gzoltar.sh` script. Directory structure should follow the
following format:
`<data dir>/<pid>/<pid>-<vid>-<tool>-gzoltar-files.tar.gz`.


Output:

Script writes to `../data/sbfl_runtimes.csv` file the time (in seconds)
GZoltar took to run for each fault, one row per fault. It looks like:

          project,fault,runtime
          Chart,1,266
          ...

